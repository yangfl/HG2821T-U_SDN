<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>中国电信智能随选网关</title>
	<link rel="icon" href="/imgs/favicon.ico" type="image/x-icon" />
	<link rel="shortcut icon" href="/imgs/favicon.ico" type="image/x-icon" />
    <link href="/css/bootstrap.min.css" rel="stylesheet">



  <!--[if lte IE 6]>
  <!-- bsie css 补丁文件 -->
  <link rel="stylesheet" type="text/css" href="/css/bootstrap-ie6.css">

  <!-- bsie 额外的 css 补丁文件 -->
  <link rel="stylesheet" type="text/css" href="/css/ie.css">
  <![endif]-->

    <link href="/css/style.css" rel="stylesheet">

  </head>
  <body>
  

<div class="container">
	<div class="row">
	<div class="col-md-12">
	<!-- <img src="/imgs/logo_shtel.png"> -->
	<h2>欢迎使用中国电信SDN网关</h2>
	</div>
	</div>
</div>
<div class="mainshow">

    <div class="container">
    <div class="row">
    	<div class="col-md-12">
    	<h3>
          <span class="glyphicon glyphicon-scale"></span> 设备状态&nbsp;
          <small>设备逻辑ID: <span id="info_myloid"></span>&nbsp;&nbsp;序列号: <span id="info_serialnum"></span></small>
          </h3>
    	</div>
    </div>
	<div class="row">
		<div class="col-md-3">
			
			<h4  style="color:#003366">
				    &nbsp;&nbsp;启动时长: <span id="info_uptime"></span>
                <br>&nbsp;&nbsp;厂家名称: <span id="info_manu"></span>
				<br>&nbsp;&nbsp;网关型号: <span id="info_model"></span>
				<br>&nbsp;&nbsp;硬件版本: <span id="info_hwversion"></span>
				<br>&nbsp;&nbsp;软件版本: <span id="info_fwversion"></span>
                <br>&nbsp;&nbsp;设备温度: <span id="info_temperature"></span>
				<hr>
				    &nbsp;&nbsp;PON发帧数: <span id="info_pontx"></span>
				<br>&nbsp;&nbsp;PON发功率: <span id="info_pontxdbm"></span>
				<br>&nbsp;&nbsp;PON收帧数: <span id="info_ponrx"></span>
				<br>&nbsp;&nbsp;PON收功率: <span id="info_ponrxdbm"></span>


				<hr>
				&nbsp;&nbsp;<span class='glyphicon glyphicon-remove-circle text-danger' id="info_upstatPON"></span> PON光路注册<br>
				&nbsp;&nbsp;<span class='glyphicon glyphicon-remove-circle text-danger' id="info_upstatManager"></span> 管理器连接<br>
				&nbsp;&nbsp;<span class='glyphicon glyphicon-remove-circle text-danger' id="info_upstatDevAuth"></span> 设备认证<br>
				&nbsp;&nbsp;<span class='glyphicon glyphicon-remove-circle text-danger' id="info_upstatController"></span> 控制器连接<br>
			</h4>
			<br><br>
		</div>
		<div class="col-md-7" align=center>
		<div class="row">
			<div class="col-md-4"  align=right>
			<br>
				<span class="glyphicon glyphicon-globe" style="font-size:800%"></span>
			</div>
			<div class="col-md-8" align=left>
				<h2>启动时长: <span id="infobig_uptime"></span></h2>
				<h2 id="showresult">....</h2>
			</div>
		</div>

		
		<br><br>
		<div class="row">
			<div class="col-md-3" style="font-size:150%" id="infobig_upstatPON" >
			<span class='glyphicon glyphicon-random' style="font-size:300%"></span><br>PON光路注册
			</div>
			<div class="col-md-3" style="font-size:150%" id="infobig_upstatManager">
			<span class='glyphicon glyphicon-cog' style="font-size:300%"></span><br>管理器连接
			</div>
			<div class="col-md-3" style="font-size:150%" id="infobig_upstatDevAuth">
			<span class='glyphicon glyphicon-check' style="font-size:300%"></span><br>设备认证
			</div>
			<div class="col-md-3" style="font-size:150%" id="infobig_upstatController">
			<span class='glyphicon glyphicon-cloud-upload' style="font-size:300%"></span><br>控制器连接
			</div>
		</div>
		<br>
		<div class="row">
			
		</div>
		<br>

        <h4><span id="info_pppaccinfo"></span><span id="info_voipaccinfo"></span></h4>
		<hr>
		<h2>无线SSID: <span class="label label-primary" id="info_ssid24g"></span> <span class="label label-primary" id="info_ssid5g"></span></h2>

		<br><br>
		</div>
		<div class="col-md-2">

		</div>
		
	</div>
	</div>

</div>
<br>
<div class="container">
	<div class="row">
	<div class="col-md-8">
    <!-- <a href="/index.html" class="btn  btn-lg btn-primary"> <span class="glyphicon glyphicon-home"></span> 返回设备主页</a> &nbsp;&nbsp; -->
	<a href="/login/passwd/000000" class="btn  btn-lg btn-primary"> <span class="glyphicon glyphicon-user"></span> 退出登录</a> &nbsp;&nbsp;
	<a href="/setloid.html" class="btn btn-lg btn-warning"> <span class="glyphicon glyphicon-download"></span> 重置LOID</a>  
	<a href="/reset.html" class="btn btn-lg btn-danger"> <span class="glyphicon glyphicon-refresh"></span> 恢复出厂</a>
	</div>
	<div class="col-md-4">
	<b>Copyright © 2017 中国电信 - All rights reserved</b>
	</div>
	</div>
</div>
<br><br><br>
    <script src="/js/jquery.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script>
    function getdevinfo()
    {
    	var errmsg="";
    	$.getJSON("/appapi/getstat/000000",
    		function(data){
    			$("#info_myloid").text(data["loid"]);
    			var bSuccess=1;
    			if(data["upstatPON"]=="OK") 
    			{
    				$("#info_upstatPON").removeClass("glyphicon-remove-circle").removeClass("text-danger").addClass("glyphicon-ok-circle").addClass("text-success");
    				$("#infobig_upstatPON").removeClass("text-warning").addClass("text-success");
    			}
                else
                {
                    $("#info_upstatPON").addClass("glyphicon-remove-circle").addClass("text-danger").removeClass("glyphicon-ok-circle").removeClass("text-success");
                    $("#infobig_upstatPON").removeClass("text-success").addClass("text-warning");
                    bSuccess=0;
                } 
    			if(data["upstatManager"]=="OK") 
    			{
    				$("#info_upstatManager").removeClass("glyphicon-remove-circle").removeClass("text-danger").addClass("glyphicon-ok-circle").addClass("text-success");
    				$("#infobig_upstatManager").removeClass("text-warning").addClass("text-success");
    			}
                else
                {
                    $("#info_upstatManager").addClass("glyphicon-remove-circle").addClass("text-danger").removeClass("glyphicon-ok-circle").removeClass("text-success");
                    $("#infobig_upstatManager").removeClass("text-success").addClass("text-warning");
                    bSuccess=0;
                } 
    			if(data["upstatDevAuth"]=="OK") 
    			{
    				$("#info_upstatDevAuth").removeClass("glyphicon-remove-circle").removeClass("text-danger").addClass("glyphicon-ok-circle").addClass("text-success");
    				$("#infobig_upstatDevAuth").removeClass("text-warning").addClass("text-success");
     			}
     			else
     			{
     				if(data["upstatDevAuthmsg"].indexOf("uthentication failure. There is no related service.")>0)
    					errmsg="认证失败:无用户业务信息，请确认用户工单状态";
    				else if(data["upstatDevAuthmsg"].indexOf("uthentication failure. Device SN number is being used.")>0)
    					errmsg="认证失败:该设备已绑定在其他用户名下";
    				else if(data["upstatDevAuthmsg"].indexOf("uthentication failure. Device is not initialized.")>0)
    					errmsg="认证失败:该设备需要恢复出厂设置操作后，才能进行激活";
    				else errmsg="认证失败:"+data["upstatDevAuthmsg"];

                    $("#info_upstatDevAuth").addClass("glyphicon-remove-circle").addClass("text-danger").removeClass("glyphicon-ok-circle").removeClass("text-success");
                    $("#infobig_upstatDevAuth").removeClass("text-success").addClass("text-warning");
                    bSuccess=0;
     			} 
    			if(data["upstatController"]=="OK") 
    			{
    				$("#info_upstatController").removeClass("glyphicon-remove-circle").removeClass("text-danger").addClass("glyphicon-ok-circle").addClass("text-success");
    				$("#infobig_upstatController").removeClass("text-warning").addClass("text-success");
    			}
                else
                {
                    $("#info_upstatController").addClass("glyphicon-remove-circle").addClass("text-danger").removeClass("glyphicon-ok-circle").removeClass("text-success");
                    $("#infobig_upstatController").removeClass("text-success").addClass("text-warning");
                    bSuccess=0;
                } 

    			if(bSuccess)
    				$("#showresult").text("已完成网络连接，您可以使用中国电信提供的业务");
    			else if(errmsg.length)
    			{
    				$("#showresult").text(errmsg);
    			}
    			else
    			{
    				$("#showresult").text("设备正在准备中，请耐心等待...");

    			}

    			var uptimestr="";
    			uptimestr+=parseInt(data["passedSystime"]/(24*3600))+"天";
    			uptimestr+=parseInt(data["passedSystime"]%(24*3600)/3600)+"时";
    			uptimestr+=parseInt(data["passedSystime"]%(3600)/60)+"分";
    			$("#info_uptime").text(uptimestr);
    			uptimestr+=parseInt(data["passedSystime"]%60)+"秒";
    			$("#infobig_uptime").text(uptimestr);
                $("#info_manu").text(data["Manufacturer"]);
    			$("#info_model").text(data["Model"]);
    			$("#info_hwversion").text(data["CustomerHWVersion"]);
    			$("#info_fwversion").text(data["CustomerSWVersion"]);
    			$("#info_serialnum").text(data["SerialNum"]);
                $("#info_temperature").text(data["Temperature"]);
    			$("#info_pontx").text(data["TxFrameCnt"]);
    			$("#info_ponrx").text(data["RxFrameCnt"]);
                // if(data["Manufacturer"]=="FiberHome")
                // {
                    $("#info_pontxdbm").text(data["TxPower"]+"dBm");
                    $("#info_ponrxdbm").text(data["RxPower"]+"dBm"); 
                // }
                // else
                // {
                //     $("#info_pontxdbm").text(Math.round(10*(Math.log10(data["TxPower"]/10000)))+"dBm");
                //     $("#info_ponrxdbm").text(Math.round(10*(Math.log10(data["RxPower"]/10000)))+"dBm");    
                // }
    			$("#info_ssid24g").text(data["SSID24G"]);
    			$("#info_ssid5g").text(data["SSID5G"]);
                if(data["pppAcc"].length)
                    $("#info_pppaccinfo").text("上网帐号"+data["pppAcc"]+" / "+data["pppPwd"]+" ");
                if(data["voipAcc"].length)
                    $("#info_voipaccinfo").text(" 语音帐号"+data["voipAcc"]+" / "+data["voipPwd"]+" ");


    			setTimeout(getdevinfo,3000);
    		});
    }
    getdevinfo();
    </script>
  </body>
</html>